<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÄ‡∏Å‡∏°‡∏ß‡∏±‡∏î‡∏™‡∏≤‡∏¢‡∏ï‡∏≤ + ‡∏•‡∏≤‡∏Å</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body{background:#111;display:flex;justify-content:center;align-items:center;height:100vh;transition:all 1s ease;}
.container{width:100%;max-width:600px;padding:20px;text-align:center;background: rgba(0,0,0,0.4);border-radius:15px;}
h1{color:#38bdf8;margin-bottom:5px;}
#gameArea{position:relative;width:100%;height:60vh;background: rgba(255,255,255,0.05);border-radius:20px;overflow:hidden;border:2px solid rgba(255,255,255,0.1);margin-bottom:15px;}
.circle{position:absolute;border-radius:50%;width:60px;height:60px;background:#38bdf8;display:flex;justify-content:center;align-items:center;color:white;font-weight:bold;transition:all 0.3s ease;cursor:pointer;}
#scoreBoard{color:white;margin-top:10px;font-size:18px;text-align:center;}
</style>
</head>
<body>
<div class="container">
<h1>‡πÄ‡∏Å‡∏°‡∏ß‡∏±‡∏î‡∏™‡∏≤‡∏¢‡∏ï‡∏≤ + ‡∏•‡∏≤‡∏Å</h1>
<p>‡∏Å‡∏î‡∏ß‡∏á‡∏Å‡∏•‡∏° ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏≤‡∏á‡∏£‡∏≠‡∏ö‡∏•‡∏≤‡∏Å‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î A‚ÜíB</p>
<div id="gameArea"></div>
<div id="scoreBoard">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0</div>
</div>

<script>
const gameArea = document.getElementById("gameArea");
const scoreBoard = document.getElementById("scoreBoard");

let score = 0;
let active = false;
let timeout;
const fixedTime = 1000; // 1 ‡∏ß‡∏¥ ‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö
const circleColors = ["#ff6b6b","#facc15","#38bdf8","#10b981","#f472b6","#a855f7"];
const bgImages = [
    "https://images.unsplash.com/photo-1519608487953-e999c86e7455",
    "https://images.unsplash.com/photo-1507525428034-b723cf961d3e",
    "https://images.unsplash.com/photo-1493244040629-496f6d136cc3",
];
bgImages.forEach(url=>{const img=new Image();img.src=url;});

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
function startGame(){
    score=0;
    scoreBoard.innerText=`‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score}`;
    document.body.style.backgroundImage=`url(${bgImages[0]})`;
    nextRound();
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà
function nextRound(){
    gameArea.innerHTML="";
    active=true;

    const isDragRound = Math.random()<0.3; // 30% ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Å‡∏¥‡∏î‡∏•‡∏≤‡∏Å A->B

    if(isDragRound){
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏á‡∏Å‡∏•‡∏° 2 ‡∏à‡∏∏‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏Å
        const circleA=document.createElement("div");
        circleA.className="circle";
        const circleB=document.createElement("div");
        circleB.className="circle";

        let colorIndex=Math.floor(score/50)%circleColors.length;
        circleA.style.background=circleColors[colorIndex];
        circleB.style.background=circleColors[colorIndex];

        const size=60;
        const maxX=gameArea.clientWidth-size;
        const maxY=gameArea.clientHeight-size;

        const ax=Math.random()*maxX;
        const ay=Math.random()*maxY;
        const bx=Math.random()*maxX;
        const by=Math.random()*maxY;

        circleA.style.left=ax+"px";
        circleA.style.top=ay+"px";
        circleB.style.left=bx+"px";
        circleB.style.top=by+"px";

        gameArea.appendChild(circleA);
        gameArea.appendChild(circleB);

        let dragging=false;

        function startDrag(e){
            e.preventDefault();
            dragging=true;
        }

        function moveDrag(e){
            if(!dragging) return;
            let x=e.touches?e.touches[0].clientX:e.clientX;
            let y=e.touches?e.touches[0].clientY:e.clientY;
            const rect=gameArea.getBoundingClientRect();
            x-=rect.left; y-=rect.top;

            const rectA=circleA.getBoundingClientRect();
            const rectB=circleB.getBoundingClientRect();
            const axc=rectA.left-rect.left+rectA.width/2;
            const ayc=rectA.top-rect.top+rectA.height/2;
            const bxc=rectB.left-rect.left+rectB.width/2;
            const byc=rectB.top-rect.top+rectB.height/2;

            const distAB=Math.hypot(x-bxc,y-byc);
            const distBA=Math.hypot(x-axc,y-ayc);

            // ‡∏•‡∏≤‡∏Å‡∏à‡∏≤‡∏Å A->B ‡∏´‡∏£‡∏∑‡∏≠ B->A ‡∏Å‡πá‡∏ñ‡∏π‡∏Å
            if(distAB<rectB.width/2 || distBA<rectA.width/2){
                dragging=false;
                score++;
                scoreBoard.innerText=`‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score}`;
                if(score%100===0){
                    let bgIndex=Math.floor(score/100)%bgImages.length;
                    document.body.style.backgroundImage=`url(${bgImages[bgIndex]})`;
                }
                clearTimeout(timeout);
                nextRound();
            }
        }

        function endDrag(){
            if(dragging){dragging=false; endGame();}
        }

        circleA.addEventListener("touchstart",startDrag);
        circleB.addEventListener("touchstart",startDrag);
        circleA.addEventListener("mousedown",startDrag);
        circleB.addEventListener("mousedown",startDrag);
        gameArea.addEventListener("touchmove",moveDrag);
        gameArea.addEventListener("mousemove",moveDrag);
        document.addEventListener("mouseup",endDrag);
        document.addEventListener("touchend",endDrag);

        timeout=setTimeout(()=>{ if(dragging){dragging=false; endGame();} }, fixedTime);
    } else {
        // ‡∏£‡∏≠‡∏ö‡πÅ‡∏ï‡∏∞‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß
        const circle=document.createElement("div");
        circle.className="circle";
        let colorIndex=Math.floor(score/50)%circleColors.length;
        circle.style.background=circleColors[colorIndex];

        const size=60;
        const maxX=gameArea.clientWidth-size;
        const maxY=gameArea.clientHeight-size;
        circle.style.left=Math.random()*maxX+"px";
        circle.style.top=Math.random()*maxY+"px";

        circle.onclick=(e)=>{
            e.stopPropagation();
            if(!active) return;
            active=false;
            score++;
            scoreBoard.innerText=`‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score}`;
            if(score%100===0){
                let bgIndex=Math.floor(score/100)%bgImages.length;
                document.body.style.backgroundImage=`url(${bgImages[bgIndex]})`;
            }
            clearTimeout(timeout);
            nextRound();
        }

        gameArea.appendChild(circle);

        timeout=setTimeout(()=>{ if(active){endGame();} }, fixedTime);
    }
}

// ‡∏Å‡∏î‡∏ú‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô = ‡∏à‡∏ö‡πÄ‡∏Å‡∏°
gameArea.addEventListener("click",e=>{
    if(!active) return;
    if(!e.target.classList.contains("circle")){
        active=false;
        clearTimeout(timeout);
        endGame();
    }
});

function endGame(){
    gameArea.innerHTML="";
    let level="";
    if(score<50) level="üò¥ ‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡∏ä‡πâ‡∏≤";
    else if(score<150) level="üôÇ ‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥";
    else if(score<400) level="üòé ‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡πÑ‡∏ß";
    else level="üî• ‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡πÑ‡∏ß‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î!";

    alert(`‡πÄ‡∏Å‡∏°‡∏à‡∏ö! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score}\n‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏≤‡∏¢‡∏ï‡∏≤: ${level}`);
}

startGame();
</script>
</body>
</html>
