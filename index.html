<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Premium Drawing App</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
body {
  margin:0;
  font-family:'Inter',sans-serif;
  background: linear-gradient(145deg,#fdf6ff,#f0fcff);
  display:flex;
  flex-direction:column;
  height:100vh;
  overflow:hidden;
}

/* Floating Toolbar */
#toolbar {
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  gap:10px;
  padding:12px;
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(10px);
  border-radius:20px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.15);
  position: absolute;
  top: 15px;
  left: 50%;
  transform: translateX(-50%);
  z-index:10;
}

/* Buttons Neumorphism */
#toolbar button, #toolbar select, #toolbar input {
  padding:8px 14px;
  font-size:16px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  background:#fff;
  box-shadow: 5px 5px 15px rgba(0,0,0,0.1), -5px -5px 15px rgba(255,255,255,0.7);
  transition:0.3s;
}
#toolbar button:hover, #toolbar input:hover, #toolbar select:hover {
  transform: translateY(-2px);
  box-shadow: 5px 5px 25px rgba(0,0,0,0.2), -5px -5px 25px rgba(255,255,255,0.85);
}
#toolbar button:active {
  transform: translateY(1px);
  box-shadow: inset 5px 5px 10px rgba(0,0,0,0.15), inset -5px -5px 10px rgba(255,255,255,0.6);
}

#canvasContainer {
  flex:1;
  overflow:hidden;
  position:relative;
}

canvas {
  background:#fff;
  display:block;
  cursor:crosshair;
  transform-origin:0 0;
  border-radius:20px;
  margin:10px auto;
  box-shadow: 0 15px 40px rgba(0,0,0,0.2);
  touch-action: none;
  transition: 0.2s;
}

/* Floating Buttons: Room Code / Join */
#roomCode {
  position:fixed;
  top:20px;
  right:20px;
  padding:10px 14px;
  border-radius:14px;
  background:linear-gradient(135deg,#8d5eff,#ff9ce5);
  color:#fff;
  font-weight:bold;
  box-shadow:5px 5px 15px rgba(0,0,0,0.25);
  cursor:default;
  z-index:10;
}
#joinParty {
  position:fixed;
  bottom:20px;
  right:20px;
  padding:12px 16px;
  border-radius:16px;
  background:linear-gradient(135deg,#34d1ff,#8d5eff);
  color:#fff;
  font-weight:bold;
  box-shadow:5px 5px 15px rgba(0,0,0,0.25);
  cursor:pointer;
  z-index:10;
}
#joinParty input {
  width:80px;
  margin-left:8px;
  border-radius:10px;
  border:1px solid #ccc;
  padding:4px 6px;
}

/* Responsive */
@media(max-width:768px){
  #toolbar{flex-wrap:wrap;padding:8px;}
  #toolbar button, #toolbar input, #toolbar select{font-size:14px;padding:6px 10px;}
}
</style>
</head>
<body>

<div id="toolbar">
  Brush: <select id="brushType">
    <option value="normal">Normal</option>
    <option value="soft">Soft</option>
    <option value="marker">Marker</option>
    <option value="spray">Spray</option>
  </select>
  Size: <input type="range" id="sizePicker" min="1" max="50" value="5">
  Opacity: <input type="range" id="opacityPicker" min="0.1" max="1" step="0.1" value="1">
  Color: <input type="color" id="colorPicker" value="#ff0000">
  <button id="undoBtn">‚Ü©Ô∏è Undo</button>
  <button id="redoBtn">‚Ü™Ô∏è Redo</button>
  <button id="clearBtn">üóëÔ∏è Clear</button>
  <button id="rotateBtn">üîÑ Rotate 0¬∞</button>
</div>

<div id="canvasContainer">
  <canvas id="drawingCanvas" width="2000" height="2000"></canvas>
</div>

<div id="roomCode">Room: 1234</div>

<div id="joinParty">
  Join Room: <input type="text" id="joinInput" placeholder="1234"><button id="joinBtn">Join</button>
</div>

<script>
// Canvas setup
const canvas = document.getElementById('drawingCanvas');
const ctx = canvas.getContext('2d');
let drawing=false, brushType='normal';
let brushColor=document.getElementById('colorPicker').value;
let brushSize=document.getElementById('sizePicker').value;
let brushOpacity=document.getElementById('opacityPicker').value;
ctx.lineCap='round';
ctx.lineJoin='round';
let rotation=0;

// Undo/Redo
let history=[], historyStep=-1;
function saveHistory(){
  history=history.slice(0,historyStep+1);
  history.push(canvas.toDataURL());
  historyStep++;
}
function undo(){ if(historyStep>0){historyStep--; let img=new Image(); img.src=history[historyStep]; img.onload=()=>ctx.drawImage(img,0,0);}}
function redo(){ if(historyStep<history.length-1){historyStep++; let img=new Image(); img.src=history[historyStep]; img.onload=()=>ctx.drawImage(img,0,0);}}

// Draw logic with brush types
function drawBrush(x,y){
  ctx.lineWidth=brushSize;
  ctx.globalAlpha=brushOpacity;
  ctx.strokeStyle=brushColor;
  ctx.fillStyle=brushColor;

  switch(brushType){
    case 'normal':
      ctx.lineTo(x,y);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(x,y);
      break;
    case 'soft':
      ctx.shadowColor=brushColor;
      ctx.shadowBlur=20;
      ctx.lineTo(x,y);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(x,y);
      ctx.shadowBlur=0;
      break;
    case 'marker':
      ctx.lineWidth=brushSize*2;
      ctx.lineTo(x,y);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(x,y);
      break;
    case 'spray':
      for(let i=0;i<10;i++){
        const offsetX=Math.random()*brushSize*2-brushSize;
        const offsetY=Math.random()*brushSize*2-brushSize;
        ctx.fillRect(x+offsetX,y+offsetY,1,1);
      }
      break;
  }
}

// Mouse / touch events
function startPos(e){drawing=true; drawPos(e); saveHistory();}
function endPos(){drawing=false; ctx.beginPath();}
function drawPos(e){
  if(!drawing) return;
  const rect=canvas.getBoundingClientRect();
  let x=e.clientX?e.clientX-rect.left:e.touches[0].clientX-rect.left;
  let y=e.clientY?e.clientY-rect.top:e.touches[0].clientY-rect.top;
  drawBrush(x/scale - offsetX/scale, y/scale - offsetY/scale);
}

canvas.addEventListener('mousedown', startPos);
canvas.addEventListener('mouseup', endPos);
canvas.addEventListener('mousemove', drawPos);
canvas.addEventListener('touchstart', startPos);
canvas.addEventListener('touchend', endPos);
canvas.addEventListener('touchmove', drawPos);

// Toolbar events
document.getElementById('brushType').onchange=e=>brushType=e.target.value;
document.getElementById('sizePicker').oninput=e=>brushSize=e.target.value;
document.getElementById('opacityPicker').oninput=e=>brushOpacity=e.target.value;
document.getElementById('colorPicker').onchange=e=>brushColor=e.target.value;
document.getElementById('undoBtn').onclick=undo;
document.getElementById('redoBtn').onclick=redo;
document.getElementById('clearBtn').onclick=()=>{ctx.clearRect(0,0,canvas.width,canvas.height); saveHistory();}

// Rotate canvas
let scale=1, offsetX=0, offsetY=0;
document.getElementById('rotateBtn').onclick=()=>{
  rotation=(rotation+15)%360;
  canvas.style.transform=`translate(${offsetX}px,${offsetY}px) scale(${scale}) rotate(${rotation}deg)`;
  document.getElementById('rotateBtn').innerText=`üîÑ Rotate ${rotation}¬∞`;
}

// Zoom / Pan
let panning=false, startX=0, startY=0;
const container=document.getElementById('canvasContainer');
container.addEventListener('wheel', e=>{
  e.preventDefault();
  const zoom=e.deltaY<0?1.1:0.9;
  scale*=zoom;
  canvas.style.transform=`translate(${offsetX}px,${offsetY}px) scale(${scale}) rotate(${rotation}deg)`;
});
container.addEventListener('mousedown', e=>{
  if(e.button===1){panning=true; startX=e.clientX-offsetX; startY=e.clientY-offsetY;}
});
container.addEventListener('mouseup', e=>panning=false);
container.addEventListener('mousemove', e=>{
  if(panning){offsetX=e.clientX-startX; offsetY=e.clientY-startY; canvas.style.transform=`translate(${offsetX}px,${offsetY}px) scale(${scale}) rotate(${rotation}deg)`;}
});

// Join Party Simulation
document.getElementById('joinBtn').onclick=()=>{
  let code=document.getElementById('joinInput').value;
  if(code) alert(`Joined Room ${code}!\n‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ß‡∏≤‡∏î‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ (‡∏à‡∏≥‡∏•‡∏≠‡∏á Local)`); 
}

// Save
document.getElementById('roomCode').onclick=()=>{
  const link=document.createElement('a');
  link.download='my_drawing.png';
  link.href=canvas.toDataURL();
  link.click();
}
</script>

</body>
</html>
