<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>เกมวัดสายตา OSU แบบง่าย</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body{background:#111;display:flex;justify-content:center;align-items:center;height:100vh;transition:all 1s ease;}
#gameContainer{position:relative;width:100%;max-width:600px;height:80vh;background:rgba(0,0,0,0.2);border-radius:20px;overflow:hidden;}
.circle{position:absolute;width:60px;height:60px;border-radius:50%;background:#38bdf8;display:flex;justify-content:center;align-items:center;color:white;font-weight:bold;cursor:pointer;transition:all 0.3s ease;}
#scoreBoard{color:white;margin-top:10px;font-size:18px;text-align:center;}
</style>
</head>
<body>
<div>
    <div id="gameContainer"></div>
    <div id="scoreBoard">คะแนน: 0</div>
</div>

<script>
const gameContainer = document.getElementById("gameContainer");
const scoreBoard = document.getElementById("scoreBoard");

let score = 0;
let active = false;
let timeout;
const fixedTime = 1000; // เวลาให้กด 1 วิ
const circleColors = ["#ff6b6b","#facc15","#38bdf8","#10b981","#f472b6","#a855f7"];
const bgImages = [
    "https://images.unsplash.com/photo-1519608487953-e999c86e7455",
    "https://images.unsplash.com/photo-1507525428034-b723cf961d3e",
    "https://images.unsplash.com/photo-1493244040629-496f6d136cc3",
];

// preload รูป
bgImages.forEach(url=>{let img=new Image();img.src=url;});

function startGame(){
    score = 0;
    scoreBoard.innerText = `คะแนน: ${score}`;
    document.body.style.backgroundImage=`url(${bgImages[0]})`;
    nextCircle();
}

function nextCircle(){
    gameContainer.innerHTML = "";
    active = true;

    const circle = document.createElement("div");
    circle.className = "circle";
    circle.style.background = circleColors[Math.floor(score/50)%circleColors.length];

    // วางวงกลมสุ่ม
    const size = 60;
    const maxX = gameContainer.clientWidth - size;
    const maxY = gameContainer.clientHeight - size;
    circle.style.left = Math.random()*maxX + "px";
    circle.style.top = Math.random()*maxY + "px";

    // ลาก / แตะวงกลม
    let dragged = false;

    circle.addEventListener("touchstart", e=>{ dragged=true; score++; nextRound(); });
    circle.addEventListener("mousedown", e=>{ dragged=true; score++; nextRound(); });

    function nextRound(){
        if(!dragged) return;
        active=false;
        scoreBoard.innerText = `คะแนน: ${score}`;
        // เปลี่ยนพื้นหลังทุก 100 คะแนน
        if(score%100===0){
            let bgIndex = Math.floor(score/100)%bgImages.length;
            document.body.style.backgroundImage=`url(${bgImages[bgIndex]})`;
        }
        clearTimeout(timeout);
        nextCircle();
    }

    gameContainer.appendChild(circle);

    timeout=setTimeout(()=>{ if(!dragged){ endGame(); }}, fixedTime);
}

// กดผิดที่อื่น = จบเกม
gameContainer.addEventListener("click", e=>{
    if(!active) return;
    if(!e.target.classList.contains("circle")){
        active=false;
        clearTimeout(timeout);
        endGame();
    }
});

function endGame(){
    gameContainer.innerHTML="";
    alert(`เกมจบ! คุณได้คะแนน: ${score}`);
}

startGame();
</script>
</body>
</html>
